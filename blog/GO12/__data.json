{"type":"data","nodes":[null,{"type":"data","data":[{"PostContent":1,"meta":2},"\u003Cbr\u003E\n\u003Cp\u003E본 글은 Golang을 공부하며 주요 내용이라 생각되는 것들을 기록해둔 자료이며, Ubuntu 22.04 LTS 기준으로 작성되었습니다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"introduction\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#introduction\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EIntroduction\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Cp\u003E서버는 각각의 요청에 대해 메타데이터를 핸들링해야 할 필요가 있다.\n이 메타데이터는 넓게 보면 두 종류로 분류할 수 있다.\n바로 요청을 올바르게 처리하기 위해 필요한 메타데이터와, 요청 처리를 언제 중지해야 할지를 나타내는 메타데이터다.\u003C\u002Fp\u003E\n\u003Cp\u003E예를 들면 어느 HTTP 서버에서는 추적 ID를 사용하여, 마이크로서비스를 통해 request chain을 식별하려고 할 수 있다.\n또한 시간이 너무 오래 걸릴 수도 있으니, 다른 마이크로서비스의 종료를 요청하는 타이머를 설정할 수도 있다.\u003C\u002Fp\u003E\n\u003Cp\u003E대부분의 언어는 \u003Cem\u003Ethreadlocal\u003C\u002Fem\u003E 변수를 사용하여 이러한 정보들을 저장하고, 특정한 쓰레드에 데이터를 연결한다.\n다만 Go의 고루틴은 값을 조회하는데 사용할 수 있는 고유한 ID가 없기 때문에, Go에서는 할 수 없는 방식이다.\u003C\u002Fp\u003E\n\u003Cp\u003EGo는 \u003Cstrong\u003Econtext\u003C\u002Fstrong\u003E라는 구성을 통해 이러한 요청 메타데이터 문제를 해결한다. 컨텍스트를 사용하는 방법을 살펴보도록 하자.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"what-is-the-context\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#what-is-the-context\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWhat Is the Context?\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Cp\u003E컨텍스트는 \u003Ccode\u003Econtext\u003C\u002Fcode\u003E 패키지에 정의된 \u003Ccode\u003EContext\u003C\u002Fcode\u003E 인터페이스를 충족시키는 인스턴스일 뿐이다. 달리 추가적인 기능이 아니다.\nGo의 이상적인 코드는 함수의 파라미터를 통해 데이터를 명시적으로 전달하는 것을 지향한다.\n컨텍스트도 마찬가지로, 함수에 대한 또다른 파라미터일 뿐이다.\nGo에서 함수의 마지막 리턴 값을 \u003Ccode\u003Eerror\u003C\u002Fcode\u003E로 하는 것이 국룰인 것처럼,\n첫 번째 파라미터를 컨텍스트로 하여 명시적으로 전달하는 것이 또다른 국룰이다.\n보통 컨텍스트 파라미터의 변수명은 대개 \u003Ccode\u003Ectx\u003C\u002Fcode\u003E로 한다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elogic\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E info \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cbr\u003E\n\u003Cp\u003E\u003Ccode\u003Econtext\u003C\u002Fcode\u003E 패키지는 \u003Ccode\u003EContext\u003C\u002Fcode\u003E 인터페이스를 정의하는것 외에도,\n컨텍스트를 만들고 래핑하기 위한 몇 가지 factory function을 포함한다.\u003C\u002Fp\u003E\n\u003Cp\u003ECLI 프로그램의 시작 지점처럼 기존 context가 없는 경우, \u003Ccode\u003Econtext.Background()\u003C\u002Fcode\u003E 함수를 통해 비어 있는 컨텍스트를 생성한다.\n일반적으로 함수에서 concrete type을 반환하는 것과는 달리, 이 함수는 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E 타입을 반환한다.\u003C\u002Fp\u003E\n\u003Cp\u003E비어 있는 컨텍스트는 시작점이라 할 수 있다.\n컨텍스트에 메타데이터를 추가할 때마다, \u003Ccode\u003Econtext\u003C\u002Fcode\u003E 패키지의 factory function 중 하나를 사용하여 기존 컨텍스트를 \u003Cem\u003E감싸주면\u003C\u002Fem\u003E 된다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003Ectx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EBackground\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\nresult\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elogic\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"a string\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cbr\u003E\n\u003Cblockquote\u003E\u003Cp\u003E\u003Ccode\u003Econtext.TODO()\u003C\u002Fcode\u003E도 비어 있는 \u003Ccode\u003Econtext.Context()\u003C\u002Fcode\u003E 인스턴스를 만드는 함수로, 개발 도중 임시적으로 필요한 경우 사용하게끔 의도되었다.\n컨텍스트를 어디서 가져와서 어떻게 사용할지 확실하지 않은 경우, \u003Ccode\u003Econtext.TODO()\u003C\u002Fcode\u003E를 사용하면 좋다.\n다만 릴리즈할 코드에서는 \u003Ccode\u003Econtext.TODO()\u003C\u002Fcode\u003E를 포함하면 안된다.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E\n\u003Cbr\u003E\n\u003Cp\u003EHTTP 서버를 작성할 때는, 컨텍스트를 획득하고 미들웨어 레이어를 거쳐 \u003Ccode\u003Ehttp.Handler\u003C\u002Fcode\u003E까지 전달하는 데 다소 다른 패턴을 사용한다.\n컨텍스트는 \u003Ccode\u003Enet\u002Fhttp\u003C\u002Fcode\u003E 패키지가 생긴 지 한참 뒤에 생긴 개념이기에,\n호환성 문제로 인해 \u003Ccode\u003Ehttp.Handler\u003C\u002Fcode\u003E 인터페이스에 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E를 파라미터로 추가하지 못했다.\u003C\u002Fp\u003E\n\u003Cp\u003E대신 기존 타입에 새로운 메소드를 추가하였다.\n\u003Ccode\u003Ehttp.Request\u003C\u002Fcode\u003E에는 컨텍스트에 관련된 두 개의 메소드가 존재한다.\u003C\u002Fp\u003E\n\u003Cul\u003E\u003Cli\u003E\u003Ccode\u003EContext()\u003C\u002Fcode\u003E 메소드는 해당 요청과 관련된 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E 인스턴스를 리턴한다.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003EWithContext()\u003C\u002Fcode\u003E 메소드는 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E 인스턴스를 파라미터로 받아서,\n해당 컨텍스트와 기존의 상태가 결합된 새로운 \u003Ccode\u003Ehttp.Request\u003C\u002Fcode\u003E 인스턴스를 반환한다.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\n\u003Cbr\u003E\n\u003Cp\u003E아래 코드는 일반적인 패턴이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EMiddleware\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehandler http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHandler\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHandler \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EHandlerFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token comment\"\u003E\u002F\u002F wrap the context with stuff\u003C\u002Fspan\u003E\n\t\tr \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\thandler\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EServeHTTP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E미들웨어에서 첫 번째로 하는 일은 \u003Ccode\u003EContext()\u003C\u002Fcode\u003E 메소드를 사용해, 요청으로부터 기존 컨텍스트를 추출해내는 것이다.\n컨텍스트에 값을 추가하고 나면, \u003Ccode\u003EWithContext()\u003C\u002Fcode\u003E 메소드를 사용해 기존 요청과 값이 추가된 컨텍스트를 기반으로 새로운 컨텍스트를 만들어낸다.\n마지막으로 \u003Ccode\u003Ehandler\u003C\u002Fcode\u003E를 호출하여 기존의 \u003Ccode\u003Ehttp.ResponseWriter\u003C\u002Fcode\u003E와 새로운 \u003Ccode\u003E*http.Request\u003C\u002Fcode\u003E를 보낸다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003Ehandler도 마찬가지로, \u003Ccode\u003EContext\u003C\u002Fcode\u003E 메소드를 사용하여 요청으로부터 컨텍스트를 추출하고,\n앞서 본 것처럼 컨텍스트를 첫 번째 파라미터로 보내면서 비즈니스 로직을 호출한다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ehandler\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\terr \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EParseForm\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWriteHeader\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusInternalServerError\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tdata \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EFormValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"data\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tresult\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Elogic\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWriteHeader\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusInternalServerError\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresult\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cbr\u003E\n\u003Cp\u003E\u003Ccode\u003EWithContext()\u003C\u002Fcode\u003E 메소드를 사용하는 경우가 한 가지 더 있다.\n바로 어플리케이션에서 다른 HTTP 서비스로 HTTP 호출을 하는 경우이다.\n컨텍스트를 미들웨어로 보낼 때처럼, \u003Ccode\u003EWithContext()\u003C\u002Fcode\u003E를 사용해 나가는 요청의 컨텍스트를 설정해야 한다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Esc ServiceCaller\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcallAnotherService\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\treq\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewRequest\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EMethodGet\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"http:\u002F\u002Fexample.com?data=\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\treq \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E req\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\tresp\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E sc\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eclient\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDo\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E resp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EBody\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EClose\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E resp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusCode \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusOK \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EErrorf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"unexpected status code %d\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E resp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusCode\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token comment\"\u003E\u002F\u002F processing response\u003C\u002Fspan\u003E\n\tid\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EprocessResponse\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EBody\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E id\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E자동완성에 뜨길래 본건데, \u003Ccode\u003Ehttp.NewRequest()\u003C\u002Fcode\u003E를 이렇게 쓸 바에는\n\u003Ccode\u003Ehttp.NewRequestWithContext()\u003C\u002Fcode\u003E를 쓰면 일반적인 패턴대로 컨텍스트를 첫 번째 파라미터로 넘길 수 있는 것 같다.\u003C\u002Fp\u003E\n\u003Cp\u003E아무튼 이제 컨텍스트를 획득하고 보내는 방법을 알게 되었으니, Cancellation을 통해 더 유용하게 사용하는 방법을 알아보자.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"cancellation\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#cancellation\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECancellation\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Cp\u003E여러 개의 고루틴을 생성하여, 서로 다른 HTTP 서비스를 호출하는 요청이 있다고 가정해보자.\n만약 서비스 하나에서 에러가 발생하여 더 이상 유효한 값을 얻을 수 없다고 한다면, 다른 고루틴을 계속 돌릴 이유가 없어진다.\n이러한 맥락에서 \u003Cstrong\u003ECancellation\u003C\u002Fstrong\u003E을 사용하며, 컨텍스트에서 이를 사용하는 방법에 대해 알아볼 것이다.\u003C\u002Fp\u003E\n\u003Cp\u003Ecancellable한 컨텍스트를 만들기 위해서는 \u003Ccode\u003Econtext.WithCancel()\u003C\u002Fcode\u003E 함수를 사용한다.\n이 함수는 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E를 파라미터로 받아서, \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E와 \u003Ccode\u003Econtext.CancelFunc()\u003C\u002Fcode\u003E를 리턴한다.\n이 때 반환받은 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E는 파라미터로 보낸 것과는 다른 컨텍스트이다.\n파라미터로 보낸 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E는 \u003Cem\u003Eparent\u003C\u002Fem\u003E 컨텍스트가 되며, 반환받은 \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E는 \u003Cem\u003Echild\u003C\u002Fem\u003E 컨텍스트이다.\n또한 child 컨텍스트는 parent 컨텍스트를 감싼(wrap)다.\n\u003Ccode\u003Econtext.CancelFunc()\u003C\u002Fcode\u003E 함수는 말 그대로 컨텍스트를 취소(cancel)하며, 취소 여부를 확인하고 있는 모든 코드에 처리를 중단하라는 신호를 보낸다.\u003C\u002Fp\u003E\n\u003Cp\u003E기본적으로 컨텍스트는 immutable한 인스턴스로 처리되기 때문에,\n정보를 추가하기 위해 컨텍스트 안의 값을 변경하기보단 이를 감싸는 child 컨텍스트를 생성한다.\n이런 방식을 통해, 컨텍스트를 코드의 가장 깊은 레이어까지 전달할 수 있다.\n반대로, 코드의 깊은 레이어에서 표면적인 레이어쪽으로 정보를 전달하는데 사용되지는 않는다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E실제로 동작하는 예제를 살펴보자.\n먼저, \u003Ccode\u003Ego mod init [MODULE_NAME]\u003C\u002Fcode\u003E으로 모듈을 선언해준다.\n그리고 \u003Cem\u003Eservers.go\u003C\u002Fem\u003E 파일을 생성하여 아래와 같이 작성한다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Epackage\u003C\u002Fspan\u003E main\n\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"net\u002Fhttp\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"net\u002Fhttp\u002Fhttptest\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"time\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EslowServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttptest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EServer \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\ts \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E httptest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EHandlerFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\ttime\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ESleep\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003E time\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ESecond\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"Slow response\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E s\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EfastServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttptest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EServer \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\ts \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E httptest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EHandlerFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EURL\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EQuery\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EGet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"error\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"true\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"error\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"ok\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E s\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003Ehttptest.Server\u003C\u002Fcode\u003E는 원격 서버와 통신하는 코드에 대해 unit test를 하기에 보다 용이하게 설계된 타입이다.\n특히 동일한 프로그램 안에 서버와 클라이언트가 존재할 경우 매우 유용하다.\u003C\u002Fp\u003E\n\u003Cp\u003E위 예제에는 서로 다른 각각의 서버를 여는 두 개의 함수가 정의되었다.\n하나는 요청이 오면 2초동안 기다렸다가 메시지를 리턴하는 서버이며,\n하나는 \u003Ccode\u003Eerror\u003C\u002Fcode\u003E라는 쿼리스트링이 \u003Ccode\u003Etrue\u003C\u002Fcode\u003E로 설정되어 있다면 \u003Ccode\u003Eerror\u003C\u002Fcode\u003E라는 메시지를, 아니면 \u003Ccode\u003Eok\u003C\u002Fcode\u003E라는 메시지를 보낸다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E이제 코드의 클라이언트 부분인, \u003Cem\u003Eclient.go\u003C\u002Fem\u003E 파일을 작성해보자.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Epackage\u003C\u002Fspan\u003E main\n\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"context\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"errors\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"fmt\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"io\u002Fioutil\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"net\u002Fhttp\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"sync\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E client \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EClient\u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcallBoth\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E errVal \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E slowURL \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fastURL \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tctx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E cancel \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithCancel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ecancel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E wg sync\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EWaitGroup\n\twg\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EAdd\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token keyword\"\u003Ego\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E wg\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDone\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\terr \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcallServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"slow\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E slowURL\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\t\u003Cspan class=\"token function\"\u003Ecancel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ego\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E wg\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDone\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\terr \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcallServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"fast\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fastURL\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"?error=\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003EerrVal\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\t\u003Cspan class=\"token function\"\u003Ecancel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\twg\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWait\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"done with both\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcallServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E label \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E url \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\treq\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewRequestWithContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EMethodGet\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E url\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"request err:\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tres\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E client\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDo\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"response err:\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tdata\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E ioutil\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EReadAll\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eres\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EBody\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"read err:\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tresult \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E result \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"result:\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E result\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E result \u003Cspan class=\"token operator\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"error\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"cancelling from\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E label\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E errors\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENew\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"error happened\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E위 예제의 \u003Ccode\u003EcallBoth()\u003C\u002Fcode\u003E 함수에서는 \u003Ccode\u003Econtext.WithCancel()\u003C\u002Fcode\u003E에 파라미터로 넘어온 컨텍스트를 넘김으로써, cancellable한 컨텍스트와 취소 함수를 생성하며,\n이 취소 함수의 이름은 \u003Ccode\u003Ecancel\u003C\u002Fcode\u003E로 짓는 게 국룰이라고 한다.\u003C\u002Fp\u003E\n\u003Cp\u003E기억해야 할 점 중 하나는 cancellable한 컨텍스트를 생성하면 취소 함수를 \u003Cem\u003E반드시\u003C\u002Fem\u003E 호출해주어야 한다는 것이다.\n만약 그렇게 하지 않으면 고루틴 또는 메모리에서 리소스 낭비가 발생할 것이다.\n취소 함수는 한 번 호출하면 두 번째부터의 호출은 무시되므로, 여러번 호출해도 상관없다.\n위 예제에서는 \u003Ccode\u003Edefer\u003C\u002Fcode\u003E를 사용하여 결과적으로 반드시 호출되게 해주었다.\u003C\u002Fp\u003E\n\u003Cp\u003E또한 cancellable한 컨텍스트, 라벨, URL 등을 캡쳐하여 두 개의 고루틴을 설정 및 실행해주었고,\n\u003Ccode\u003Esync.WaitGroup\u003C\u002Fcode\u003E의 \u003Ccode\u003Esync()\u003C\u002Fcode\u003E 메소드를 사용하여 고루틴들이 끝날 때까지 대기해주었다.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003EcallServer()\u003C\u002Fcode\u003E 함수는 간단한 클라이언트로, 취소 가능한 컨텍스트를 통해 요청을 생성하여 전송한다.\n만약 에러가 발생하거나 서버로부터 받은 문자열 결과값이 \u003Ccode\u003Eerror\u003C\u002Fcode\u003E라면, 에러를 리턴한다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E이제 메인함수를 살펴보자. \u003Cem\u003Emain.go\u003C\u002Fem\u003E 파일을 아래와 같이 작성한다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Epackage\u003C\u002Fspan\u003E main\n\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"context\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"os\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tss \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EslowServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E ss\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EClose\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tfs \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EfastServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E fs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EClose\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EBackground\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token function\"\u003EcallBoth\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E os\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EArgs\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ss\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EURL\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EURL\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003Emain()\u003C\u002Fcode\u003E 함수에서는 서버를 열고, 생성된 컨텍스트로 클라이언트를 돌려 서버에 요청을 보낸다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E작성된 코드를 빌드하여 실행해보자.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-bash\"\u003E$ go build .\u002F\u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E.\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E위 명령어를 치면 모듈이 빌드되어 실행 파일이 생성된다. 나의 경우 생성된 실행 파일은 \u003Cem\u003Econtext-cancel\u003C\u002Fem\u003E이었다.\n두 가지 경우에 대해, 해당 파일을 실행해보자. 아래 경우는 에러가 발생하지 않았을 때이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-bash\"\u003E$ .\u002Fcontext-cancel \u003Cspan class=\"token boolean\"\u003Efalse\u003C\u002Fspan\u003E\nfast result: ok\nslow result: Slow response\n\u003Cspan class=\"token keyword\"\u003Edone\u003C\u002Fspan\u003E with both\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cbr\u003E\n\u003Cp\u003E아래 경우는 에러가 발생하였을 때이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-bash\"\u003E$ .\u002Fcontext-cancel \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\nfast result: error\ncancelling from fast\nslow response err: Get \u003Cspan class=\"token string\"\u003E\"http:\u002F\u002F127.0.0.1:39207\"\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin class-name\"\u003E:\u003C\u002Fspan\u003E context canceled\n\u003Cspan class=\"token keyword\"\u003Edone\u003C\u002Fspan\u003E with both\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003EfastServer\u003C\u002Fcode\u003E에 대한 요청에서 에러가 발생하였으므로 컨텍스트가 취소된다.\n이 때 \u003Ccode\u003ENewRequestWithContext()\u003C\u002Fcode\u003E가 실행 중이므로, 컨텍스트의 취소를 감지하여, 고루틴이 멈추게 된 것이다.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\u003Cp\u003E만약 위 프로그램을 실행해보았다면, 에러가 발생했음에도 프로그램이 즉각 종료되지 않았다는 점을 알 수 있을 것이다.\n이는 \u003Ccode\u003EslowServer()\u003C\u002Fcode\u003E가 종료되는 것을 기다리기 때문이다.\n만약 \u003Ccode\u003EslowServer()\u003C\u002Fcode\u003E의 타임아웃을 2초에서 6초로 늘린다면,\n\u003Ccode\u003Ehttptest.Server blocked in Close after 5 seconds, waiting for connections\u003C\u002Fcode\u003E와 같이 신기한 에러 메세지가 출력되는 것을 확인할 수 있을 것이다.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003EslowServer()\u003C\u002Fcode\u003E를 아래와 재작성해주면 컨텍스트의 취소를 제대로 처리하여, 즉시 서버가 종료될 것이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EslowServer_rewrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttptest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EServer \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\ts \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E httptest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewServer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EHandlerFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eselect\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDone\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n\t\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"server shut down\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003Etime\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EAfter\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E6\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003E time\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ESecond\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n\t\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"Slow response\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E s\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E아마 클라이언트 단의 컨텍스트가 취소되면, 요청에 있는 컨텍스트의 \u003Ccode\u003EDone\u003C\u002Fcode\u003E 신호가 들어오는 것 같다.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E\n\u003Cp\u003E위 예제들의 소스코드는 \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjunhyuk0801\u002FLearning-golang\u002Ftree\u002Fmaster\u002F12-context\u002Fcancellation\" rel=\"nofollow\"\u003E여기\u003C\u002Fa\u003E에서 확인해볼 수 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E이렇게, 수동으로 컨텍스트를 취소하는 방법에 대해 살펴보았다.\n이러한 방식도 유용하지만, 다음 섹선에서는 타임아웃을 통해 취소를 자동화하는 방법에 대해 살펴볼 것이다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"timers\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#timers\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETimers\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Cp\u003E서버가 하는 일 중 가장 중요한 것 중 하나는 요청들을 관리하는 것이다.\n아기 개발자들은 가끔 서버가 가능한 한 많은 요청을 받고, 각 클라이언트에 결과를 반환할 수 있을 때까지 작업을 해야 한다고 생각한다.\n하지만 이는 아기 개발자들의 잘못된 생각이다. 응애!\u003C\u002Fp\u003E\n\u003Cp\u003E서버는 공유 리소스와 비슷한 성격을 가진다.\n각 사용자들은 서버에 가능한 많은 요청을 보내고 결과를 얻고 싶어하며, 이 때 다른 사용자의 요청에 대해서는 별 관심이 없다.\n자고로 공유 리소스는 모든 사용자에게 동일한 시간만큼 제공할 수 있도록 관리할 필요성이 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E서버는 로드(작업량)를 관리하기 위해, 보통 네 가지 방법을 사용한다.\u003C\u002Fp\u003E\n\u003Col\u003E\u003Cli\u003E동시에 처리하는 요청의 수 제한\u003C\u002Fli\u003E\n\u003Cli\u003E대기 큐에서 기다리고 있는 요청의 수 제한\u003C\u002Fli\u003E\n\u003Cli\u003E요청이 처리되는 시간 제한\u003C\u002Fli\u003E\n\u003Cli\u003E요청이 사용할 수 있는 리소스의 양 제한(메모리, 디스크 등)\u003C\u002Fli\u003E\u003C\u002Fol\u003E\n\u003Cp\u003EGo에서는 앞의 세 개의 제한을 처리하는 도구를 제공한다.\n특히 1번과 2번의 경우 이미 우리가 본 것이다.\n1번의 경우 고루틴의 수를 제한하면 서버가 동시에 처리하는 요청의 수가 관리되는 것이며,\n2번은 buffered channel의 크기를 조절하면 해결된다.\u003C\u002Fp\u003E\n\u003Cp\u003E그리고, 컨텍스트를 통해 요청이 얼마나 오래동안 처리될 수 있는지를 제한할 수 있다.\n어플리케이션을 만들 때, 사용자가 불만족스러운 경험을 하기 전에 요청을 완료하려면 얼마나 시간이 걸릴 지에 대해 알고 있어야 한다.\n만약 요청을 실행할 수 있는 최대 시간을 알고 있다면, 요청에 컨텍스트를 적용할 수 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E시간이 제한된 컨텍스트를 생성하는 방법은 두 가지가 있다.\n하나는 \u003Ccode\u003Econtext.WithTimeout()\u003C\u002Fcode\u003E 함수를 사용하는 것이다. 이 함수는 기존의 컨텍스트와 타임아웃을 나타내는 \u003Ccode\u003Etime.Duration\u003C\u002Fcode\u003E 인스턴스를 파라미터로 받는다.\n그리고 명시된 만큼의 시간이 지나면 자동으로 취소되는 컨텍스트와, 컨텍스트를 바로 취소할 수 있는 취소 함수가 함께 리턴된다.\u003C\u002Fp\u003E\n\u003Cp\u003E두 번째 방법은 \u003Ccode\u003Econtext.WithDeadline()\u003C\u002Fcode\u003E 함수를 사용하는 것이다.\n이 함수도 마찬가지로 기존의 컨텍스트를 받으며, \u003Ccode\u003Etime.Duration\u003C\u002Fcode\u003E 인스턴스 대신 \u003Ccode\u003Etime.Time\u003C\u002Fcode\u003E 인스턴스를 파라미터로 받는다.\n\u003Ccode\u003Econtext.WithTimeout()\u003C\u002Fcode\u003E 함수처럼 해당 시각이 지나면 컨텍스트는 자동으로 취소되는 컨텍스트와 컨텍스트를 바로 취소할 수 있는 취소 함수가 리턴된다.\n만약 \u003Ccode\u003Econtext.WithDeadline()\u003C\u002Fcode\u003E에 과거의 \u003Ccode\u003Etime.Time\u003C\u002Fcode\u003E 시각을 보내면, 이미 취소된 컨텍스트를 리턴한다.\u003C\u002Fp\u003E\n\u003Cp\u003E만약 컨텍스트가 자동으로 닫히는 시각을 알아내고 싶다면, \u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E 인스턴스의 \u003Ccode\u003EDeadline()\u003C\u002Fcode\u003E 메소드를 사용한다.\n해당 메소드는 컨텍스트가 닫히는 시각을 나타내는 \u003Ccode\u003Etime.Time\u003C\u002Fcode\u003E 인스턴스와, 타임아웃이 설정되어 있는지 여부를 \u003Ccode\u003Etrue\u003C\u002Fcode\u003E나 \u003Ccode\u003Efalse\u003C\u002Fcode\u003E로 리턴한다.\n따라서 \u003Cem\u003Ecomma ok idiom\u003C\u002Fem\u003E을 적용하면 된다.\u003C\u002Fp\u003E\n\u003Cp\u003E적용된 예제가 길어져서, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjunhyuk0801\u002FLearning-golang\u002Ftree\u002Fmaster\u002F12-context\u002Fcontext_timeout.go\" rel=\"nofollow\"\u003E여기\u003C\u002Fa\u003E에서 확인하면 될 듯 하다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E요청에 대한 전반적인 타임아웃을 설정할 때, 이 타임아웃을 세분화할 수도 있다.\n이를테면 한 서비스에서 다른 서비스를 호출하는 구조가 있을 수 있는데,\n네트워크 호출을 실행할 수 있는 시간을 제한하여 나머지 처리 시간이나 다른 네트워크 호출에 사용할 시간을 예약할 수 있다.\n앞서 보았던 \u003Ccode\u003Econtext.WithTimeout()\u003C\u002Fcode\u003E이나 \u003Ccode\u003Econtext.WithDeadline()\u003C\u002Fcode\u003E으로 parent 컨텍스트를 감싸는 child 컨텍스트를 생성하여,\n각각에 호출에 소요되는 시간을 제어할 수 있는 것이다.\u003C\u002Fp\u003E\n\u003Cp\u003E특히 child 컨텍스트의 타임아웃은 parent 컨텍스트의 타임아웃에 종속된다.\n이를테면 parent 컨텍스트의 타임아웃이 2초이고 child 컨텍스트의 타임아웃이 3초라고 하면,\nparent 컨텍스트의 타임아웃인 2초가 지나면 child 컨텍스트도 자동으로 취소된다.\u003C\u002Fp\u003E\n\u003Cp\u003E마찬가지로 예제가 좀 길어져서, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjunhyuk0801\u002FLearning-golang\u002Ftree\u002Fmaster\u002F12-context\u002Fparent_child_timeout.go\" rel=\"nofollow\"\u003E여기\u003C\u002Fa\u003E서 확인하면 된다.\n이 코드를 실행해보면 parent 컨텍스트의 타임아웃이 먼저 찾아올 것이고, 그와 동시에 child 컨텍스트도 취소된다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"handling-context-cancellation-in-your-own-code\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#handling-context-cancellation-in-your-own-code\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EHandling Context Cancellation in Your Own Code\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Cp\u003E대부분의 경우 코드 내에서 타임아웃이나 취소에 대해 걱절할 필요는 없다.\n일반적인 코드들은 기란이 그렇게 오래 걸리지 않는다.\n다만 다른 HTTP 서비스를 호출하거나, 데이터베이스를 호출할 때에는 컨텍스트를 파라미터로 잘 넘겨주어야 한다.\n얘네들은 보통 타임아웃이 발생하거나 오류가 발생하여 취소를 할만한 상황이 종종 나오는 편이므로, 컨텍스트를 넘김으로써 취소를 처리해주기 용이하다.\u003C\u002Fp\u003E\n\u003Cp\u003E만약 컨텍스트가 취소되면 중단되어야 하는 코드를 작성하는 경우, 동시성을 통해 취소 체크를 할 수 있다(10장에서 이미 살펴보았다).\n\u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E 타입은 취소를 관리하는 두 가지 메소드를 포함하고 있다.\n\u003Ccode\u003EDone()\u003C\u002Fcode\u003E 메소드는 \u003Ccode\u003Estruct{}\u003C\u002Fcode\u003E 타입의 채널을 리턴한다. 해당 채널은 취소 함수나 타임아웃이 발생할 때 close된다.\n이 때 closed channel에 읽기를 시도하면 반드시 zero value를 리턴한다.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\u003Cp\u003E이 때 취소할 수 없는 컨텍스트에서 \u003Ccode\u003EDone()\u003C\u002Fcode\u003E 메소드를 호출하면 \u003Ccode\u003Enil\u003C\u002Fcode\u003E을 반환한다.\n게다가 \u003Ccode\u003Enil\u003C\u002Fcode\u003E 채널에서 읽기를 시도하면 프로그램이 끝날 때까지 읽기를 시도할 것이기 때문에 멈출 것이다.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E\n\u003Cbr\u003E\n\u003Cp\u003E\u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E의 \u003Ccode\u003EErr()\u003C\u002Fcode\u003E 메소드는 만약 컨텍스트가 아직 활성화되어 있다면 \u003Ccode\u003Enil\u003C\u002Fcode\u003E을 반환한다.\n반면 만약 컨텍스트가 취소되어 있다면, \u003Ccode\u003Econtext.Cancelled\u003C\u002Fcode\u003E 또는 \u003Ccode\u003Econtext.DeadlineExceeded\u003C\u002Fcode\u003E 둘 중 하나의 sentinel error를 반환한다.\n\u003Ccode\u003Econtext.Cancelled\u003C\u002Fcode\u003E는 컨텍스트를 명시적으로 취소했을 때, \u003Ccode\u003Econtext.DeadlineExceeded\u003C\u002Fcode\u003E는 타임아웃이 발생했을 때 리턴된다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ElongRunningThing\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tticker \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E time\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewTicker\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etime\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ESecond \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E ticker\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EStop\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\tctx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E cancel \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithTimeout\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E time\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDuration\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Etime\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ESecond\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ecancel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E result \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eselect\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003Eticker\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EC\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n\t\t\tresult \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDone\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n\t\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E result\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ctx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EErr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ElongRunningThingManager\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E wrapper \u003Cspan class=\"token keyword\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tresult \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\n\t\terr    \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tch \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emake\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Echan\u003C\u002Fspan\u003E wrapper\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ego\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tresult\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ElongRunningThing\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tch \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003E wrapper\u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003Eresult\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token keyword\"\u003Eselect\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ecase\u003C\u002Fspan\u003E data \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003Ech\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eresult\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eerr\n\t\u003Cspan class=\"token keyword\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E&lt;-\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDone\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ctx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EErr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003ElongRunningThing()\u003C\u002Fcode\u003E 함수는 타임아웃이 발생할 때까지 \u003Ccode\u003Eresult\u003C\u002Fcode\u003E의 값을 누적하는 함수이다.\n(원래 타임아웃 자체가 에러 상황을 상정하기 때문에, 실제로 이런 함수를 작성하면 안된다!)\n\u003Ccode\u003Ecase &lt;-ctx.Done():\u003C\u002Fcode\u003E로 타임아웃이 발생할 시 함수가 리턴된다.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003ElongRunningThingManager()\u003C\u002Fcode\u003E 함수는 \u003Ccode\u003Eselect\u003C\u002Fcode\u003E문을 통해 \u003Ccode\u003ElongRunningThing()\u003C\u002Fcode\u003E 함수의 값이 반환되기까지 기다리거나,\n혹은 컨텍스트가 취소될 때까지 기다린다. 취소된다면 에러와 함께 함수가 리턴된다.\u003C\u002Fp\u003E\n\u003Cp\u003E이 때 각각의 \u003Ccode\u003Eselect\u003C\u002Fcode\u003E문의 \u003Ccode\u003Ecase &lt;-ctx.Done():\u003C\u002Fcode\u003E 안에, \u003Ccode\u003Ectx.Err()\u003C\u002Fcode\u003E가 있음을 확인할 수 있다.\n이 메소드가 어떤 출력 결과를 반환하는지에 집중하여 확인해볼 것이다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E이어서 \u003Ccode\u003Emain()\u003C\u002Fcode\u003E 함수를 작성해보자.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EBackground\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tctx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E cancel \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithCancel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\ttime\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EAfterFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etime\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ESecond\u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E cancel\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tnum\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ElongRunningThingManager\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E5\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Enum\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003Etime.AfterFunc(time.Second*3, cancel)\u003C\u002Fcode\u003E 라인의 유무에 따라 출력이 달라지는 것을 확인할 수 있다.\n이 라인을 지운다면 컨텍스트가 타임아웃에 의해 취소되며, 지우지 않는다면 컨텍스트가 \u003Ccode\u003Ecancel\u003C\u002Fcode\u003E 함수에 의헤 취소되기 때문이다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E본 절에서는 컨텍스트를 통한 타임아웃의 명시 및 취소 방법에 대해 알아보았다.\n물론 이전에 보았던 \u003Ccode\u003Etime.After()\u003C\u002Fcode\u003E 함수를 통해서도 취소가 가능하지만, 개인적으로는 컨텍스트를 통한 방식이 더 좋아보이는 것 같다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"values\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#values\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EValues\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Cp\u003E컨텏트의 또 다른 용도라고 할 수 있다. 컨텍스트는 프로그램의 다른 컴포넌트에 요청에 대한 메타데이터를 전달하는 방법을 제공한다.\u003C\u002Fp\u003E\n\u003Cp\u003E물론 파라미터를 통해 명시적으로 데이터를 전달하는 방식을 최우선적으로 고려하는 것이 좋다.\nGo에서는 명시적인 데이터 전달을 이상적으로 여긴다.\n특히 함수가 특정 데이터를 반드시 필요로 한다면, 해당 데이터가 어디서 오는지(보내는지) 명확하게 정의되어야 한다.\u003C\u002Fp\u003E\n\u003Cp\u003E하지만 데이터를 명시적으로 전달하지 못할 만한 상황이 존재할 수밖에 없다.\n그런 경우는 대부분 HTTP 요청 핸들러와 관련 미들웨어에서 발생한다.\u003C\u002Fp\u003E\n\u003Cp\u003E앞서 보았듯 모든 요청 핸들러는 각각 request, response를 파라미터로 받는다.\n그런데 미들웨어의 핸들러가 해당 값을 사용할 수 있게 만들려면, context에 값을 저장해주어야 한다.\n이러한 경우는 유저의 JWT(JSON Web Token)을 추출하거나, 미들웨어 레이어를 거쳐 핸들러나 비즈니스 로직으로 전달되는 요청별 GUID를 생성하고자 하는 경우 발생할 수 있다.\u003C\u002Fp\u003E\n\u003Cp\u003E이러한 경우에 대응하여, \u003Ccode\u003Econtext\u003C\u002Fcode\u003E 패키지의 다양한 팩토리 함수 중 값을 저장할 수 있는 컨텍스트를 만드는 함수인 \u003Ccode\u003Econtext.WithValue()\u003C\u002Fcode\u003E가 존재한다.\n이 함수는 세 개의 파라미터를 받는다. 파라미터는 각각 parent 컨텍스트와, 값을 저장할 key와, 값이다.\n그리고 parent 컨텍스트를 감싸며 key-value 페어가 존재하는 child 파라미터를 리턴한다.\n이 때 각각 key와 value의 타입은 \u003Ccode\u003Einterface{}\u003C\u002Fcode\u003E로 선언되어 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E만약 어떤 컨텍스트나 해당 컨텍스트의 아무 parent 컨텍스트 중 값이 저장되어 있는지 확인하려면,\n\u003Ccode\u003Econtext.Context\u003C\u002Fcode\u003E의 \u003Ccode\u003EValue()\u003C\u002Fcode\u003E 메소드를 사용하면 된다.\n이 메소드는 Key를 파라미터로 받아서 해당 Key에 대한 값을 리턴한다.\n만약 해당 Key에 대한 값이 존재하지 않는다면 \u003Ccode\u003Enil\u003C\u002Fcode\u003E이 리턴된다.\n타입이 \u003Ccode\u003Einterface{}\u003C\u002Fcode\u003E이기 때문에, 반환받은 값이 유효한지 확인하려면 comma ok idiom을 사용해주어야 한다.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\u003Cp\u003E기본적으로 context chain에 저장된 값을 검색하려면 \u003Cem\u003Elinear search\u003C\u002Fem\u003E를 사용할 수밖에 없다.\n만약 컨텍스트에 저장된 값이 많지 않다면 성능상의 문제가 크진 않겠지만, 컨텍스트에 값을 너무 많이 저장하게 되면 성능이 뚝뚝 떨어질 것이다.\n요청을 처리하기 위해 context chain에 값을 필요 이상으로 많이 집어넣어야 한다면, 리팩토링을 한번 해보는 게 좋을 것이다.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E\n\u003Cbr\u003E\n\u003Cp\u003E컨텍스트에 저장할 key든 value든 타입이 \u003Ccode\u003Einterface{}\u003C\u002Fcode\u003E이기 때문에 아무거나 다 넣을 수 있긴 하지만,\n\u003Ccode\u003Emap\u003C\u002Fcode\u003E처럼 key나 value의 타입을 고정해주는 것이 좋다(특히 key는 더더욱! 비교가 가능한 타입으로 고정해주는 것이 좋다).\u003C\u002Fp\u003E\n\u003Cp\u003E아래 예제에서는 \u003Ccode\u003Eint\u003C\u002Fcode\u003E를 기반으로, export되지 않은 타입을 생성해주었다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E userKey \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E만약 key의 타입으로 string이나 다른 public type을 사용한다면, 다른 패키지에서 동일한 키값이 생성될 수 있고, 이는 충돌로 이어질 수 있다.\n그렇게 되면 컨텍스트에서 다른 패키지에서 쓴 데이터를 읽는 등, 요상한 문제가 발생하여 디버그가 힘들어지기도 한다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E이렇게 export되지 않는 key의 타입을 선언해주고 나면, export되지 않는 상수를 하나 선언해준다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E key userKey \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E위 상수와 타입 모두 export되지 않았기 때문에, 패키지 바깥에서 이 데이터를 확인할 방법이 없다.\n따라서 컨텍스트에 겹치는 key에 덮어쓰거나 접근할 방법이 없을 것이며, 충돌도 발생하지 않을 것이다.\n또한 만약 컨텍스트에 여러 개의 값을 저장해야 한다면 \u003Ccode\u003Eiota\u003C\u002Fcode\u003E를 사용할 수도 있을 것이다.\n기본적으로 상수의 값이 의미있는 것이 아니라 단지 구분을 하기 위해서만 사용되기 때문에, \u003Ccode\u003Eiota\u003C\u002Fcode\u003E를 사용하기 매우 적절한 경우라고 할 수 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E다음으로는 컨텍스트에 값을 집어넣거나, 값을 읽어오는 API를 작성해줄 것이다.\n패키지 외부의 코드에서 컨텍스트의 값을 읽고 써야 할 필요가 있는 경우, 이 함수들을 export한다.\n값을 저장하는 컨텍스트를 생성하는 함수의 이름은 \u003Ccode\u003EContextWith\u003C\u002Fcode\u003E로 시작해야 한다.\n또한 컨텍스트로부터 값을 읽어와서 리턴하는 함수의 이름은 \u003Ccode\u003EFromContext\u003C\u002Fcode\u003E로 끝나야 한다.\u003C\u002Fp\u003E\n\u003Cp\u003E컨텍스트에 값을 읽고 쓰는 함수들의 예제를 살펴보도록 하자.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EContextWithUser\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E user \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E key\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E user\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EUserFromContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Ebool\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tuser\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E ctx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekey\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E user\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cbr\u003E\n\u003Cp\u003E사용자 정보를 관리하는 코드를 작성했으니, 사용하는 방법을 알아볼 것이다.\n먼저, 아래 예제는 쿠키에서 유저 ID를 추출하는 미들웨어이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EextractUser\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tuserCookie\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E req\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ECookie\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"user\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E userCookie\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EValue\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EMiddleware\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eh http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHandler\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHandler \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EHandlerFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tuser\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EextractUser\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Er\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWriteHeader\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusUnauthorized\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\t\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tctx \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EContextWithUser\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E user\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tr \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\th\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EServeHTTP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E해당 미들웨어 내에서는 \u003Ccode\u003Euser\u003C\u002Fcode\u003E의 쿠키 값을 추출한 후, \u003Ccode\u003EContext()\u003C\u002Fcode\u003E 메소드를 사용해 요청의 컨텍스트를 얻는다.\n그리고 앞서 정의한 \u003Ccode\u003EContextWithUser()\u003C\u002Fcode\u003E 함수를 통해 유저 정보가 포함된 컨텍스트를 생성한다.\n그리고 기존 \u003Ccode\u003E*http.Request\u003C\u002Fcode\u003E에서 \u003Ccode\u003EWithContext()\u003C\u002Fcode\u003E 메소드를 통해, 새로 생성된 컨텍스트를 포함하는 새로운 \u003Ccode\u003E*http.Request\u003C\u002Fcode\u003E 인스턴스를 만들어 준다.\n마지막으로 \u003Ccode\u003Ehttp.Handler\u003C\u002Fcode\u003E의 다음 함수를 호출해준다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ec Controller\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EhandleRequest\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tuser\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EUserFromContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003Eok \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWriteHeader\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusInternalServerError\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tdata \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EURL\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EQuery\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EGet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"data\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tresult\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E c\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELogic\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EbusinessLogic\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E user\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWriteHeader\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStatusInternalServerError\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tw\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWrite\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebyte\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresult\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E위 예제의 핸들러에서는 \u003Ccode\u003EContext()\u003C\u002Fcode\u003E 메소드로 요청에 대한 컨텍스트를 획득하여,\n해당 컨텍스트로부터 \u003Ccode\u003EUserFromContext()\u003C\u002Fcode\u003E 함수를 통해 유저 정보를 추출한다. 그리고 비즈니스 로직을 호출한다.\u003C\u002Fp\u003E\n\u003Cp\u003E파라미터를 통해 값을 넘기기보단, 이런 방식을 통해 컨텍스트에 값을 저장하는게 더 나을 만한 상황도 존재한다. 앞서 말했던 GUID를 추적하는 경우이다.\n이 정보는 비즈니스 로직보단 어플리케이션 관리를 위해 사용된다.\n이러한 방식을 사용하면 GUID에 대해 알 필요가 없는 비즈니스 로직이 이 정보를 볼 수 없게 되며, 로그를 작성하거나 다른 서버에 연결할 때 사용할 수 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003E다음은 컨텍스트가 서비스에서 서비스로 전달될 때, GUID를 포함하여 이 값을 추적하고 로그를 기록하는 예제이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Epackage\u003C\u002Fspan\u003E tracker\n\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"context\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"fmt\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"net\u002Fhttp\"\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token string\"\u003E\"github.com\u002Fgoogle\u002Fuuid\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E guidKey \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E key guidKey \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcontextWithGUID\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E guid \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E key\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E guid\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EguidFromContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Ebool\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tg\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E ctx\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekey\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E g\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EMiddleware\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eh http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHandler\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHandler \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EHandlerFunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EResponseWriter\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E guid \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHeader\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EGet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"X-GUID\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E guid \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\tctx \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcontextWithGUID\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E guid\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\t\tctx \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EcontextWithGUID\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E uuid\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENew\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\tr \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EWithContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\th\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EServeHTTP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ew\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E Logger \u003Cspan class=\"token keyword\"\u003Estruct\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003El Logger\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ELog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E message \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E guid\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EguidFromContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E ok \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tmessage \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E fmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ESprintf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"GUID: %s - %s\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E guid\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E message\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token comment\"\u003E\u002F\u002F do logging\u003C\u002Fspan\u003E\n\tfmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EPrintln\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emessage\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ERequest\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Er \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tctx \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E r\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E guid\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E ok \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EguidFromContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E ok \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tr\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EHeader\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EAdd\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"X-GUID\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E guid\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E r\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003EMiddleware()\u003C\u002Fcode\u003E 함수는 요청으로부터 GUID를 추출하거나 새로은 GUID를 만들고, 컨텍스트에 이 값을 저장하여 새로운 컨텍스트를 생성한다.\n그리고 다음의 Middleware chain을 호출한다.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003ELogger\u003C\u002Fcode\u003E 구조체에는 컨텍스트와 문자열을 받아서 제네릭하게 로그를 남기는 메소드가 있다.\n만약 컨텍스트에 GUID가 있다면, 로그 메시지의 앞에 추가적으로 출력한다.\n\u003Ccode\u003ERequest\u003C\u002Fcode\u003E 함수는 다른 서비스를 호출하기 위해 사용되며, 컨텍스트에 GUID가 있다면 Request header에 GUID가 추가된 \u003Ccode\u003E*http.Request\u003C\u002Fcode\u003E 인스턴스를 리턴한다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\u003Cp\u003EInterface 포스트에서 보았던 것처럼, 인터페이스를 통해 Dependency Injection을 하는 패턴을 사용해볼 것이다.\n이 방법을 통해 비즈니스 로직으로부터 불필요한 정보를 분리할 수 있다.\u003C\u002Fp\u003E\n\u003Cp\u003E먼저 \u003Ccode\u003ELogger\u003C\u002Fcode\u003E 인터페이스를 정의하고, request decorator를 나타내는 함수 타입과, 이에 관련된 비즈니스 로직 구조체를 만들어준다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E RequestDecorator \u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Ehttp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\n\n\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E Logger \u003Cspan class=\"token keyword\"\u003Einterface\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token function\"\u003ELog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econtext\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E BusinessLogic \u003Cspan class=\"token keyword\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tRequestDecorator RequestDecorator\n\tLogger           Logger\n\tRemote           \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E이제 비즈니스 로직을 구현해준다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ebl BusinessLogic\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EbusinessLogic\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx context\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EContext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E user \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eerror\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tbl\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELogger\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ELog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ESprintf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"starting businessLogic for %s with %s\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E user\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\treq\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ENewRequestWithContext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EMethodGet\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E bl\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERemote\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"?query=\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tbl\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELogger\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ELog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ESprintf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"error making remote request: %v\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\treq \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E bl\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ERequestDecorator\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tres\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E http\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EDefaultClient\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDo\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tbl\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELogger\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ELog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ESprintf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"error making remote request: %v\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\tbody \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EBody\n\t\u003Cspan class=\"token keyword\"\u003Edefer\u003C\u002Fspan\u003E body\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EClose\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\tout\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E ioutil\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EReadAll\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ebody\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\t\tbl\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELogger\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ELog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ectx\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fmt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ESprintf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"error making remote request: %v\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E err\n\t\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Estring\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eout\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EGUID가 \u003Ccode\u003ELogger\u003C\u002Fcode\u003E와 request decorator에게 전달되는 과정에서 비즈니스 로직은 이를 인식하지 못하며,\n프로그램 로직에 필요한 데이터와 프로그램 관리에 필요한 데이터를 분리할 수 있다.\n코드에서 연관성을 확인할 수 있는 유일한 부분은 바로 \u003Ccode\u003Emain()\u003C\u002Fcode\u003E 함수이다.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-go\"\u003Ebl \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E BusinessLogic\u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n\tRequestDecorator\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E tracker\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERequest\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n\tLogger\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E           tracker\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELogger\u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n\tRemote\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E           \u003Cspan class=\"token string\"\u003E\"http:\u002F\u002Fwww.example.com\u002Fquery\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E&#125;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cbr\u003E\n\u003Cp\u003E전체 코드는 \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjunhyuk0801\u002FLearning-golang\u002Ftree\u002Fmaster\u002F12-context\u002Fvalues\" rel=\"nofollow\"\u003E여기\u003C\u002Fa\u003E에서 확인할 수 있다.\u003C\u002Fp\u003E\n\u003Cbr\u003E\u003Cbr\u003E\n\u003Ch2 id=\"references\"\u003E\u003Ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#references\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EReferences\u003C\u002Fh2\u003E\n\u003Chr\u003E\n\u003Ccenter\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flearning.oreilly.com\u002Flibrary\u002Fview\u002Flearning-go\u002F9781492077206\u002F\" rel=\"nofollow\"\u003E\u003Cimg src=\"https:\u002F\u002Flearning.oreilly.com\u002Fcovers\u002Furn:orm:book:9781492077206\u002F400w\u002F\"\u003E\u003C\u002Fa\u003E \u003Cbr\u003E\n\u003Ca href=\"https:\u002F\u002Flearning.oreilly.com\u002Flibrary\u002Fview\u002Flearning-go\u002F9781492077206\u002F\" rel=\"nofollow\"\u003EJon Bodner, 『Learning Go』, O’Reilly Media, Inc.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fcenter\u003E\n\u003Cbr\u003E\u003Cbr\u003E",{"title":3,"date":4,"excerpt":5,"categories":6,"coverImage":8,"coverWidth":9,"coverHeight":10,"slug":11},"컨텍스트","2022-09-09T00:00:00.000Z","The Context",[7],"Golang","\u002Fimages\u002Fjefferson-santos-fCEJGBzAkrU-unsplash.jpg",16,9,"GO12"],"uses":{"params":["post"]}}]}